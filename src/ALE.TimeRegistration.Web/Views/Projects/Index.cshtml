<body class="BackgroundClock">
    <h1 class="m-5">ProjectPage</h1>
    <div id="app" class="row">
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle btn-lg yellow-text" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Projects
            </button>
            <div class="dropdown-menu yellow-text" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" v-for="project in projects" v-on:click="getProjectTasks(project)">{{project.name}}</a>
            </div>
        </div>
        <div v-if="currentProject" class="col-md-6">
            <h3>{{currentProject.name}}</h3>
            <h4>Tasks:</h4>
            <ul class="list-group">
                <li class="list-group-item yellow-text" v-for="task in tasks" v-on:click="getTask(task)" v-bind:class="getTaskCssClass(task)">
                    <a>{{task.taskName}}</a>
                </li>
            </ul>
        </div>
        <div class="card yellow-text float-right" style="width: 18rem; border-color: #feda4a" v-if="currentTask">
            <div class="card-body">
                <h5 class="card-title">Project: {{currentProject.name}}</h5>
                <h6 class="card-subtitle mb-2 text-muted">Task: {{currentTask.taskName}}</h6>
                <p class="card-text">{{currentTask.info}}</p>
                <button class="btn-primary" style="width: 100px">start</button>
                <button class="btn-primary" style="width: 100px">stop</button>
            </div>
        </div>
    </div>    
</body>


@section scripts{
    <script>
        var apiURL = 'https://localhost:5001/api/projects';
        var app = new Vue({
            el: '#app',
            data: {
                projects: null,
                currentProject: null,
                tasks: null,
                currentTask: null
            },
            created: function () {
                var self = this;
                self.getProjects();
            },
            methods: {
                getProjects: function () {
                    var self = this;
                    axios.get(`${apiURL}`)
                        .then(function (response) {
                            self.projects = response.data;
                        })
                        .catch(function (error) {
                            console.error(error);
                        });
                },

                getProjectTasks: function (project) {
                    var self = this;
                    self.currentProject = project;
                    self.tasks = project.tasks;
                },

                getTask: function (task) {
                    var self = this;
                    self.currentTask = task;
                },

                getTaskCssClass: function (task) {
                    var self = this;
                    if (task == self.currentTask) {
                        return "selectedTask";
                    }
                }
            }

        });
    </script>
}